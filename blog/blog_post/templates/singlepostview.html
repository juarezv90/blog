{% extends 'base.html' %} {% block content %}

<section id="singledisplay">
  <div class="singlepostdisplay">
    <h3>{{ post.title }}</h3>
    <p>{{ post.post_date }}</p>
  </div>
  <img
    src="{{ MEDIA_URL }}/{{ post.post_image }}"
    alt="post image hero"
    srcset=""
    id="postimage"
  />
  <div id="post">{{ post.blog_post.html|safe }}</div>
  <div id="likes">
    {% if user.is_authenticated %}
    <form action="{% url 'like_post' post.id %}" method="POST">
      {% csrf_token %} {% if post_is_like %}
      <button onclick="submitform(this)">Unlike</button>
      {% else %}
      <button onclick="submitform(this)">Like</button>
      {% endif %}
    </form>
    {% endif %}
    <span>Likes: {{post.number_of_likes}}</span>
  </div>
  <script>
    const submitform = (e) => {
      e.preventDefault();
    };
  </script>
</section>

<section id="comments">
  <h3>Comments:</h3>
  {% for comment in comments %}
  <article class="comment">
    <h4 style="text-transform: uppercase">{{ comment.user.first_name }}</h4>
    <p class="comment_date">{{comment.date_posted}}</p>
    <p class="comment_text">{{ comment.comment_text}}</p>
  </article>
  {% endfor %}
</section>

<section id="add_comment">
  {% if user.is_authenticated %}
  <button onclick="show_form()">Add comment</button>
  <form
    method="POST"
    id="comment_form"
    action="{% url 'addcomment' post.id %}"
    class="hide"
  >
    <h4>Add Comment:</h4>
    {% csrf_token %} {{ comment_form.comment_text }}
    <button>submit</button>
  </form>
  <script>
    const show_form = () => {
      document.getElementById("comment_form").classList.toggle("hide");
    };
  </script>
  {% else %}
  <p>Please login to leave comment</p>
  {% endif %}
</section>

{% endblock %}
